# 第一章 MongoDB简介

## MongoDB数据库的设计理念、建立原则

### 1 选择正确的工具完成正确的工作

一直以来，人们使用传统的关系型数据库（MongoDB是文档型数据库）来存储各种各样的数据，不考虑数据是否适合其相关的模型。

+ MongoDB是在“处理文档而不是行、更加快捷、大规模扩展、简单易操作”的概念上建立起来的，这就意味着需要抛弃一些传统数据库所具有的特点。

但是，缺乏事务（transaction）和其他传统数据库功能并不意味着MongoDB不稳定或不能用于管理重要数据。

MongoDB非常适合解决某些问题如，分析（为网站提供实时的Google Analytics）、复杂化数据结构（博客文章、评论）。

+ MongoDB的另一个关键概念是，数据库始终要有一个以上的副本。

当一个数据库故障时，则可以很容易地从其他服务器还原该数据库。

### 2 缺乏对事务的固有支持

MongoDB数据库不包括事务性语义（为数据一致性和存储提供保证的元素）。

### 3 JSON和MongoDB

JSON（JavaScript对象表示法）不只是一种交换数据的好方法，也可以很好地存储数据。

+ MongoDB将所有内容存储在一个文档中，这种情况下MongoDB就像JSON，并且这个模型提供了丰富且富有表现力的数据存储方式。

*JSON有效地描述了给定文档中的所有内容，无需事先指定文档的结构。JSON是无模式的，文档可以单独更新或独立于其他任何文档进行更改。JSON还可以将所有相关数据存储在一个位置。*

+ MongoDB使用**BSON**（binary JSON）来存储数据。

​    BSON添加了一些在JSON中不可行的特点，例如，数字型数据的扩展类型（int32，int64），并支持处理二进制数据。

*JSON与CSV不同，可以存储结构化内容；与XML不同，JSON使内容更易于理解和使用。*

下面就是一个JSON格式存储数据：

```
{    
"firstname": "Peter",
"lastname": "Membrey",
"numbers": [
   {
      "phone": "+852 1234 5678"
   },
   {
      "fax": "+44 1234 565 555"
   }
  ] 
}
```

+ 当在文档中添加复杂内容如列表（数组）时，就会创建嵌入式文档。

### 4 采用非关系方法

+ MongoDB在BSON文档中存储数据，所以这些数据是独立的。即使相同的文档存储在一起，每个文档之间不构成相关关系。

+ 由于MongoDB中的查询是在文档中查找特定的键和值，因此信息可以轻松的分布到尽可能多的服务器上。每一个服务器都可以查看其包含的内容并返回结果。这几乎有效地实现了线性可扩展性和性能。

+ MongoDB不提供主复制，即两个单独服务器都可以接受写入请求。它具有分片功能，即允许在多台计算机之间划分数据，每台计算机负责更新数据集的不同部分。

### 5 选择性能与功能

memcached——提供高速数据缓存

## Fitting everything together

### 1 Generating or creating a key

+ document是MongoDB中的存储单位，在RDBMS中，称为row。

document可以存储复杂数据如：lists,dictionaries,lists of dictionaries。

文档可以由任意数量的key和values组成，key不仅仅是一个标签，它大致相当于RDBMS中的列，我们用key来引用文档中的数据。

MongoDB中每个文档都具有唯一标识符`_id`。

*如果不指定_id值，MongoDB会自动生成，默认 _id格式是ObjectId，是一个12字节的唯一标识符，可以在分布式环境中独立生成。*

### 2 键和值

documents是由键和值组成的。

键和值总是成对出现。

MongoDB不要求每个文档都有相同的字段或每个有相同名字的字段都得有相同类型的值。

如果键值对不在文档的中，那就相当于不存在，不需要像RDBMS一样得输入“null”。

### 3 Implementing collections

collections一定程度上类似于tables，但是没有tables严格。

在RDBMS中，tables是严格定义的，其中只可以放入指定元素；在MongoDB中，集合中可以放入任何类型的元素，具有很强的灵活性，但是否应将某些文档存储在同一集合中取决于应用程序。

### Database

database就是一系列集合的构成。

## 功能列表

### WiredTiger

MongoDB的默认存储引擎

















